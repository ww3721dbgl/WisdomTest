<!DOCTYPE html>
<html style="height:100%;">
	<head>
		<meta charset="UTF-8">
		<title>南京市农路智慧管理平台</title>
		<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
		<link rel="stylesheet" href="../../../css/common.css" />
		<link rel="stylesheet" href="../../../css/rural-roads.css">
		<link rel="stylesheet" href="../../../layui/css/layui.css">
		<link rel="stylesheet" href="../../../layui/component/formSelects-v4.css">
		<link rel="stylesheet" type="text/css" href="../../../css/component.css"/>
	</head>
	<body class="dlgcxmzl-view distribution-user-page">
		<div class="iframe-content test-manage-page">
			<div class="layui-tab layui-tab-brief">
			  <ul class="layui-tab-title">
				<li>分配用户</li>
				<button class="layui-btn back-btn r">返回</button>
			  </ul>
			  <div class="layui-tab-content layui-col-sm12" style="height: 100px;">
				<div class="layui-tab-item layui-show">
					<div class="shuttle-table-warp layui-row">
						<div class="layui-form-item layui-col-xs6 layui-col-sm6 layui-col-md6">
							<div class="layui-col6-warp l-warp">
								<div class="all-people-warp">
									<div class="distribution-user-header layui-form">
										<div class="layui-form-item layui-col-xs12 layui-col-sm12 layui-col-md12">
											<label class="layui-form-label">所有人员</label>
											<div class="layui-input-block">
											  	<div class="layui-col-xs4 layui-col-sm4 layui-col-md4">
											  		 <select name="modules" lay-verify="required" lay-search="">
												          <option value="">部门筛选</option>
												          <option value="1">layer</option>
												          <option value="2">form</option>
												      </select>
											  	</div>
											  	<div class="layui-col-xs4 layui-col-sm4 layui-col-md4">
											  		<div style="margin-left:20px;">
											  			<select name="modules" lay-verify="required" lay-search="">
												          <option value="">人员筛选</option>
												          <option value="1">layer</option>
												          <option value="2">form</option>
												      </select>
											  		</div>
											  	</div>
											</div>
										</div>
									</div>
									<table class="layui-hide" id="test"  lay-even="" lay-skin="nob"width="100%"lay-filter="test"></table>
								</div>
							</div>
							
						</div>
						<div class="layui-form-item layui-col-xs6 layui-col-sm6 layui-col-md6">
							<div class="layui-col6-warp r-warp">
								<div class="has-distribution-role-warp">
									<div class="distribution-user-header">已分配角色</div>
									<table class="layui-hide" id="test2"  lay-even="" lay-skin="nob"width="100%"lay-filter="test2"></table>
								</div>
							</div>
						</div>
					</div>	    	
				</div>
			  </div>
			</div> 
		</div>
		<script type="text/javascript" src="../../../js/jquery.min.js"></script>
		<script type="text/javascript" src="../../../js/rural-roads.js"></script>
		<script type="text/javascript" src="../../../layui/layui.js"></script>
		<script type="text/javascript" src="../../../js/utils.js"></script>
	</body>
</html>
<script type="text/html" id="toolbarDemo">
  <div class="layui-btn-container">
  	<button type="button" class="layui-btn back-btn"lay-event="getCheckData">分配角色</button>
  </div>
</script>
<script type="text/html" id="toolbarDemo2">
  <div class="layui-btn-container">
  	<button type="button" class="layui-btn del-btn"lay-event="delCheckData">删除角色</button>
  </div>
</script>
<script type="text/javascript">
	layInit(function(layui,$){
		   //返回
			$(".layui-tab-title .back-btn").click(function(){
				$('iframe', window.parent.document).attr("src","系统设置-new/9.4.2角色管理/1-0角色管理.html");
			});
			
			
			var dataJson1 = [
					{"th1": "1","th2": "","th3": "","th4": "","th5": "","th6": ""},
					{"th1": "2","th2": "","th3": "","th4": "","th5": "","th6": ""},
					{"th1": "3","th2": "","th3": "","th4": "","th5": "","th6": ""}
			  	];
			allpeoData(dataJson1);
			function allpeoData(data){
				layui.table.render({
					  	elem: '#test',
					  	height: 566,
					  	toolbar: '#toolbarDemo',
					  	cols: [[
							{type: 'checkbox', fixed: 'left',width:80},
					  		{field: 'th1', title: '归属公司'},
					  		{field: 'th2', title: '归属部门'},
							{field: 'th3', title: '登录名'},
							{field: 'th4', title: '姓名'},
							{field: 'th5', title: '电话'},
							{field: 'th6', title: '手机'},
					  	]],
					  	data:dataJson1 
					  	,skin:"nob"
					  	,even: true,
						limit:200
					  	
				});
			}
			
		var dataJson2 =  [
				{"th1": "a","th2": "","th3": "","th4": "","th5": "","th6": ""},
				{"th1": "b","th2": "","th3": "","th4": "","th5": "","th6": ""},
				{"th1": "c","th2": "","th3": "","th4": "","th5": "","th6": ""},
				{"th1": "d","th2": "","th3": "","th4": "","th5": "","th6": ""}
		  	];
		distributionTable(dataJson2);
		function distributionTable(data){
			var data2Length = dataJson2.length;
			    layui.table.render({
				  	elem: '#test2',
				  	height: 566,
				  	toolbar: '#toolbarDemo2',
				  	cols: [[
						{type: 'checkbox', fixed: 'left',width:80},
				  		{field: 'th1', title: '归属公司'},
				  		{field: 'th2', title: '归属部门'},
						{field: 'th3', title: '登录名'},
						{field: 'th4', title: '姓名'},
						{field: 'th5', title: '电话'},
						{field: 'th6', title: '手机'},
				  	]],
				  	data:data
				  	,skin:"nob"
				  	,even: true
				  	,limit:200
					  	
				});
		};
		
		//监听分配按钮
		layui.table.on('toolbar(test)', function(obj){
		    var checkStatus = layui.table.checkStatus(obj.config.id);
		    switch(obj.event){
		      case 'getCheckData':
		        var data = checkStatus.data;
		        
		        //判断是否全选
				if(!checkStatus.isAll){
					setTimeout(function(){
						$(".all-people-warp .layui-table-body tbody .layui-form-checked").each(function(index,item){
							var index = $(item).parents("tr").index();
							console.log(index);
						});
					},100);
					console.log();
				}else{
					console.log("全选");
					console.log(checkStatus);
				}
//				allpeoData(dataJson1);
//				distributionTable(dataJson2);
		        break;
		    };
		});
	
		//监听删除按钮
		layui.table.on('toolbar(test2)', function(obj){
		    var checkStatus = layui.table.checkStatus(obj.config.id);
		    switch(obj.event){
		      case 'delCheckData':
		       var data = checkStatus.data;
		        
		        //判断是否全选
				if(!checkStatus.isAll){
					$(".has-distribution-role-warp .layui-table-body tbody .layui-form-checked").each(function(index,item){
						var trIndex = $(item).parents("tr").index();
						
					});
					
				}else{
					
				}
				
		        break;
		    };
		});
	
	
	});
</script>